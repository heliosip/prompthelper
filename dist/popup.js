(()=>{"use strict";var e,t={7964:(e,t,s)=>{var a=s(4848),r=s(5338),n=s(1594);const o=Supabase,l=process.env.REACT_APP_SUPABASE_URL||"",i=process.env.REACT_APP_SUPABASE_ANON_KEY||"",c=(0,o.createClient)(l,i),d=({onAuthSuccess:e})=>{const[t,s]=(0,n.useState)(""),[r,o]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[d,u]=(0,n.useState)("");return(0,a.jsxs)("div",{style:{padding:"8px"},children:[(0,a.jsx)("h3",{children:"Sign In / Sign Up"}),d&&(0,a.jsx)("p",{style:{color:"red"},children:d}),(0,a.jsx)("input",{type:"email",placeholder:"Email",value:t,onChange:e=>s(e.target.value),style:{width:"100%",marginBottom:"8px"}}),(0,a.jsx)("input",{type:"password",placeholder:"Password",value:r,onChange:e=>o(e.target.value),style:{width:"100%",marginBottom:"8px"}}),(0,a.jsx)("input",{type:"text",placeholder:"Username (optional)",value:l,onChange:e=>i(e.target.value),style:{width:"100%",marginBottom:"8px"}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("button",{onClick:async()=>{u("");const{error:s}=await c.auth.signInWithPassword({email:t,password:r});s?u(s.message):e()},style:{marginRight:"8px"},children:"Sign In"}),(0,a.jsx)("button",{onClick:async()=>{u("");const{data:s,error:a}=await c.auth.signUp({email:t,password:r});if(a)return void u(a.message);const n=s.user?.id;if(!n)return;const{error:o}=await c.from("profile").insert([{id:n,username:l}]);o?u(o.message):e()},children:"Sign Up"})]})]})},u=({template:e,onSubmit:t,onCancel:s})=>{const[r,o]=(0,n.useState)(e.content),[l,i]=(0,n.useState)(!0);return(0,a.jsxs)("div",{className:"p-4 border rounded",children:[(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm mt-2",children:[(0,a.jsxs)("div",{children:["Category: ",e.category]}),(0,a.jsxs)("div",{children:["AI Tool: ",e.aiTool]}),(0,a.jsxs)("div",{children:["Output Type: ",e.outputType]}),(0,a.jsxs)("div",{children:["Prompt Type: ",e.promptType]})]}),e.description&&(0,a.jsx)("div",{className:"mt-2 text-gray-600",children:e.description})]}),(0,a.jsxs)("form",{onSubmit:s=>{s.preventDefault();const a=((e,t,s)=>({templateId:e.id,content:t,saveToHistory:s}))(e,r,l);t(a)},children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block mb-2 font-medium",children:"Prompt Content"}),(0,a.jsx)("textarea",{className:"w-full h-64 p-3 border rounded font-mono",value:r,onChange:e=>o(e.target.value),placeholder:"Edit your prompt here..."})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:l,onChange:e=>i(e.target.checked),className:"form-checkbox"}),(0,a.jsx)("span",{children:"Save this prompt to history"})]})}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded",children:"Send to Chat"})]})]})]})};var p=s(7164),h=s(3357),m=s(6929),x=s(2533),g=s(8872),j=s(423);const v=()=>{const[e,t]=(0,n.useState)(!1),[s,r]=(0,n.useState)(!0),[o,l]=(0,n.useState)(null),[i,v]=(0,n.useState)([]),[y,b]=(0,n.useState)([]),[f,S]=(0,n.useState)([]),[w,A]=(0,n.useState)(null),[C,k]=(0,n.useState)("templates"),[N,O]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const{data:e,error:s}=await c.auth.getSession();if(s)return t(!1),void l(null);e.session&&e.session.user?(t(!0),l(e.session.user.email||null)):(t(!1),l(null))}catch(e){t(!1),l(null)}finally{r(!1)}})();const{data:e}=c.auth.onAuthStateChange(((e,s)=>{s?.user?(t(!0),l(s.user.email||null)):(t(!1),l(null))}));return()=>{e.subscription.unsubscribe()}}),[]);const E=(0,n.useCallback)((async()=>{try{const e=await chrome.storage.local.get(["templates"]);v(e.templates||[])}catch(e){O("Failed to load templates.")}}),[]),B=(0,n.useCallback)((async()=>{if(e)try{const e=await fetch(`/api/templates?email=${o}`);if(!e.ok)throw new Error(`Failed to fetch user templates: ${e.status}`);const t=await e.json();b(t)}catch(e){O("Failed to load user templates.")}}),[o,e]),P=(0,n.useCallback)((async()=>{try{const e=await fetch(`/api/history?email=${o}`);if(!e.ok)throw new Error(`Failed to fetch history: ${e.status}`);const t=await e.json();S(t)}catch(e){O("Failed to load history.")}}),[o]);(0,n.useEffect)((()=>{e&&(E(),B(),P())}),[e,E,B,P,C]);return s?(0,a.jsx)(p.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,a.jsx)(h.A,{})}):e?(0,a.jsxs)(p.A,{sx:{padding:2},children:[(0,a.jsxs)(m.A,{variant:"h5",sx:{marginBottom:2},children:["Welcome, ",o]}),(0,a.jsx)(x.A,{variant:"contained",color:"primary",onClick:async()=>{await c.auth.signOut(),t(!1),l(null),v([]),b([]),S([])},sx:{marginBottom:3},children:"Sign Out"}),(0,a.jsxs)(g.A,{value:C,onChange:(e,t)=>k(t),textColor:"primary",indicatorColor:"primary",sx:{marginBottom:2},children:[(0,a.jsx)(j.A,{label:"Templates",value:"templates"}),(0,a.jsx)(j.A,{label:"Custom",value:"custom"}),(0,a.jsx)(j.A,{label:"History",value:"history"})]}),"templates"===C&&(0,a.jsx)(p.A,{children:i.length>0?i.map((e=>(0,a.jsx)(p.A,{sx:{padding:2,border:"1px solid #ddd",marginBottom:1,borderRadius:1,cursor:"pointer","&:hover":{backgroundColor:"#f5f5f5"}},onClick:()=>A(e),children:e.name},e.id))):(0,a.jsx)(m.A,{children:"No templates available."})}),"custom"===C&&(0,a.jsx)(p.A,{children:y.length>0?y.map((e=>(0,a.jsx)(p.A,{sx:{padding:2,border:"1px solid #ddd",marginBottom:1,borderRadius:1},children:e.name},e.id))):(0,a.jsx)(m.A,{children:"No custom templates available."})}),"history"===C&&(0,a.jsx)(p.A,{children:f.length>0?f.map((e=>(0,a.jsx)(p.A,{sx:{padding:2,border:"1px solid #ddd",marginBottom:1,borderRadius:1},children:e.content},e.id))):(0,a.jsx)(m.A,{children:"No history available."})}),w&&(0,a.jsx)(u,{template:w,onSubmit:()=>A(null),onCancel:()=>A(null)})]}):(0,a.jsx)(d,{onAuthSuccess:()=>t(!0)})},y=document.getElementById("root");if(y){(0,r.H)(y).render((0,a.jsx)(v,{}))}const b=document.getElementById("root");b&&(window._popupRoot||(window._popupRoot=(0,r.H)(b)),window._popupRoot.render((0,a.jsx)(v,{})))},1594:e=>{e.exports=React},5206:e=>{e.exports=ReactDOM}},s={};function a(e){var r=s[e];if(void 0!==r)return r.exports;var n=s[e]={exports:{}};return t[e](n,n.exports,a),n.exports}a.m=t,e=[],a.O=(t,s,r,n)=>{if(!s){var o=1/0;for(d=0;d<e.length;d++){for(var[s,r,n]=e[d],l=!0,i=0;i<s.length;i++)(!1&n||o>=n)&&Object.keys(a.O).every((e=>a.O[e](s[i])))?s.splice(i--,1):(l=!1,n<o&&(o=n));if(l){e.splice(d--,1);var c=r();void 0!==c&&(t=c)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,r,n]},a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={887:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var r,n,[o,l,i]=s,c=0;if(o.some((t=>0!==e[t]))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(i)var d=i(a)}for(t&&t(s);c<o.length;c++)n=o[c],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=self.webpackChunkprompthelper=self.webpackChunkprompthelper||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=a.O(void 0,[522],(()=>a(7964)));r=a.O(r)})();